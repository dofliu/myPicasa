# PDF æµ®æ°´å°åŠŸèƒ½ä½¿ç”¨æŒ‡å—

## åŠŸèƒ½æ¦‚è¿°

PDF æµ®æ°´å°åŠŸèƒ½å…è¨±æ‚¨ç‚º PDF æ–‡ä»¶æ·»åŠ æ–‡å­—æˆ–åœ–ç‰‡æµ®æ°´å°ï¼Œæ”¯æ´è‡ªè¨‚ä½ç½®ã€é€æ˜åº¦ã€å¤§å°ç­‰åƒæ•¸ã€‚

## åŠŸèƒ½ç‰¹è‰²

### æ–‡å­—æµ®æ°´å°
- âœ… è‡ªè¨‚æµ®æ°´å°æ–‡å­—å…§å®¹
- âœ… å¯èª¿æ•´å­—é«”å¤§å°ï¼ˆ10-200ï¼‰
- âœ… æ”¯æ´æ—‹è½‰è§’åº¦ï¼ˆ-180Â° åˆ° 180Â°ï¼‰
- âœ… è‡ªå‹•ä½¿ç”¨ç³»çµ±ä¸­æ–‡å­—é«”
- âœ… æ”¯æ´é€æ˜åº¦èª¿æ•´

### åœ–ç‰‡æµ®æ°´å°
- âœ… æ”¯æ´ PNGã€JPGã€JPEGã€BMP æ ¼å¼
- âœ… PNG æ ¼å¼æ”¯æ´é€æ˜èƒŒæ™¯
- âœ… å¯èª¿æ•´ç¸®æ”¾æ¯”ä¾‹ï¼ˆ5%-50%ï¼‰
- âœ… æ”¯æ´é€æ˜åº¦èª¿æ•´

### é€šç”¨è¨­å®š
- âœ… 5 ç¨®ä½ç½®é¸æ“‡ï¼šæ­£ä¸­å¤®ã€å·¦ä¸Šè§’ã€å³ä¸Šè§’ã€å·¦ä¸‹è§’ã€å³ä¸‹è§’
- âœ… é€æ˜åº¦èª¿æ•´ï¼ˆ10%-100%ï¼‰
- âœ… é‚Šè·èª¿æ•´ï¼ˆ0-100 åƒç´ ï¼‰- æ§åˆ¶æµ®æ°´å°èˆ‡é é¢é‚Šç·£çš„è·é›¢
- âœ… è‡ªå‹•å¥—ç”¨åˆ°æ‰€æœ‰é é¢

## ä½¿ç”¨æ–¹å¼

### åœ¨ GUI ä»‹é¢ä¸­ä½¿ç”¨

1. **å•Ÿå‹•æ‡‰ç”¨ç¨‹å¼**
   ```bash
   python picasa6.py
   ```

2. **åˆ‡æ›åˆ°æ–‡ä»¶è½‰æ›å·¥å…·åˆ†é **
   - é»æ“Šé ‚éƒ¨çš„ã€ŒğŸ“„ æ–‡ä»¶è½‰æ›å·¥å…·ã€åˆ†é 
   - é¸æ“‡ã€ŒğŸ·ï¸ PDF æµ®æ°´å°ã€å­åˆ†é 

3. **é¸æ“‡ PDF æ–‡ä»¶**
   - é»æ“Šã€ŒğŸ“‚ ç€è¦½ã€æŒ‰éˆ•
   - é¸æ“‡è¦æ·»åŠ æµ®æ°´å°çš„ PDF æ–‡ä»¶

4. **é¸æ“‡æµ®æ°´å°é¡å‹**
   - **æ–‡å­—æµ®æ°´å°**ï¼šè¼¸å…¥æ–‡å­—å…§å®¹ï¼Œèª¿æ•´å­—é«”å¤§å°å’Œæ—‹è½‰è§’åº¦
   - **åœ–ç‰‡æµ®æ°´å°**ï¼šé¸æ“‡æµ®æ°´å°åœ–ç‰‡ï¼Œèª¿æ•´ç¸®æ”¾æ¯”ä¾‹

5. **è¨­å®šé€šç”¨åƒæ•¸**
   - **æµ®æ°´å°ä½ç½®**ï¼šé¸æ“‡æµ®æ°´å°åœ¨é é¢ä¸Šçš„ä½ç½®
   - **é€æ˜åº¦**ï¼šèª¿æ•´æµ®æ°´å°çš„é€æ˜ç¨‹åº¦
   - **é‚Šè·**ï¼šè¨­å®šæµ®æ°´å°èˆ‡é é¢é‚Šç·£çš„è·é›¢ï¼ˆé è¨­ 10pxï¼Œè¨­ç‚º 0 å¯å®Œå…¨è²¼é‚Šï¼‰

6. **åŸ·è¡Œ**
   - é»æ“Šã€Œâœ¨ æ·»åŠ æµ®æ°´å°ã€æŒ‰éˆ•
   - é¸æ“‡è¼¸å‡ºæª”æ¡ˆçš„å„²å­˜ä½ç½®
   - ç­‰å¾…è™•ç†å®Œæˆ

### åœ¨ç¨‹å¼ç¢¼ä¸­ä½¿ç”¨

#### æ·»åŠ æ–‡å­—æµ®æ°´å°

```python
from utils.doc_converter import add_text_watermark_to_pdf

# åŸºæœ¬ç”¨æ³•
add_text_watermark_to_pdf(
    input_path="input.pdf",
    output_path="output_with_text.pdf",
    watermark_text="Â© 2025 æ©Ÿå¯†æ–‡ä»¶",
    position='center',
    opacity=0.3,
    font_size=40,
    rotation=45
)
```

**åƒæ•¸èªªæ˜ï¼š**
- `input_path`: è¼¸å…¥ PDF è·¯å¾‘
- `output_path`: è¼¸å‡º PDF è·¯å¾‘
- `watermark_text`: æµ®æ°´å°æ–‡å­—
- `position`: ä½ç½®ï¼ˆ'center', 'top-left', 'top-right', 'bottom-left', 'bottom-right'ï¼‰
- `opacity`: é€æ˜åº¦ï¼ˆ0.0-1.0ï¼‰
- `font_size`: å­—é«”å¤§å°
- `rotation`: æ—‹è½‰è§’åº¦ï¼ˆåº¦ï¼‰
- `margin`: é‚Šè·ï¼ˆåƒç´ ï¼Œé è¨­ 10ï¼‰

#### æ·»åŠ åœ–ç‰‡æµ®æ°´å°

```python
from utils.doc_converter import add_image_watermark_to_pdf

# åŸºæœ¬ç”¨æ³•
add_image_watermark_to_pdf(
    input_path="input.pdf",
    output_path="output_with_image.pdf",
    watermark_image_path="logo.png",
    position='bottom-right',
    opacity=0.5,
    scale=0.2
)
```

**åƒæ•¸èªªæ˜ï¼š**
- `input_path`: è¼¸å…¥ PDF è·¯å¾‘
- `output_path`: è¼¸å‡º PDF è·¯å¾‘
- `watermark_image_path`: æµ®æ°´å°åœ–ç‰‡è·¯å¾‘
- `position`: ä½ç½®ï¼ˆ'center', 'top-left', 'top-right', 'bottom-left', 'bottom-right'ï¼‰
- `opacity`: é€æ˜åº¦ï¼ˆ0.0-1.0ï¼‰
- `scale`: ç¸®æ”¾æ¯”ä¾‹ï¼ˆç›¸å°æ–¼é é¢å¯¬åº¦ï¼Œä¾‹å¦‚ 0.2 è¡¨ç¤º 20%ï¼‰
- `margin`: é‚Šè·ï¼ˆåƒç´ ï¼Œé è¨­ 10ï¼‰

## ä½ç½®èªªæ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ top-left      top-right     â”‚
â”‚                             â”‚
â”‚         center              â”‚
â”‚                             â”‚
â”‚ bottom-left  bottom-right  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ä½¿ç”¨ç¯„ä¾‹

### ç¯„ä¾‹ 1ï¼šç‚ºåˆç´„æ·»åŠ æ©Ÿå¯†æ¨™è¨˜

```python
from utils.doc_converter import add_text_watermark_to_pdf

add_text_watermark_to_pdf(
    "contract.pdf",
    "contract_confidential.pdf",
    "æ©Ÿå¯†æ–‡ä»¶ CONFIDENTIAL",
    position='center',
    opacity=0.2,
    font_size=60,
    rotation=45,
    color=(255, 0, 0)  # ç´…è‰²
)
```

### ç¯„ä¾‹ 2ï¼šæ·»åŠ å…¬å¸ Logo

```python
from utils.doc_converter import add_image_watermark_to_pdf

add_image_watermark_to_pdf(
    "report.pdf",
    "report_branded.pdf",
    "company_logo.png",
    position='top-right',
    opacity=0.7,
    scale=0.15
)
```

### ç¯„ä¾‹ 3ï¼šé è…³ç‰ˆæ¬Šè²æ˜

```python
from utils.doc_converter import add_text_watermark_to_pdf

add_text_watermark_to_pdf(
    "document.pdf",
    "document_copyrighted.pdf",
    "Â© 2025 Your Company. All Rights Reserved.",
    position='bottom-right',
    opacity=0.5,
    font_size=12,
    rotation=0
)
```

### ç¯„ä¾‹ 4ï¼šæ¯ç‰‡åº•ç¨¿æ•ˆæœï¼ˆå®Œå…¨è²¼é‚Šï¼‰

```python
from utils.doc_converter import add_text_watermark_to_pdf

# å³ä¸‹è§’å®Œå…¨è²¼é‚Šçš„æµ®æ°´å°ï¼Œé©åˆæ¯ç‰‡åº•ç¨¿
add_text_watermark_to_pdf(
    "template.pdf",
    "template_marked.pdf",
    "DRAFT - è‰ç¨¿",
    position='bottom-right',
    opacity=0.3,
    font_size=14,
    rotation=0,
    margin=5  # è¨­å®šè¼ƒå°çš„é‚Šè·ï¼Œæ›´è²¼è¿‘é‚Šç·£
)
```

### ç¯„ä¾‹ 5ï¼šåœ–ç‰‡æµ®æ°´å°è²¼é‚Š

```python
from utils.doc_converter import add_image_watermark_to_pdf

# å…¬å¸ Logo ç·Šè²¼å³ä¸‹è§’
add_image_watermark_to_pdf(
    "report.pdf",
    "report_branded.pdf",
    "company_logo.png",
    position='bottom-right',
    opacity=0.8,
    scale=0.15,
    margin=5  # æ›´è²¼è¿‘é‚Šç·£
)
```

## æ¸¬è©¦

å°ˆæ¡ˆæä¾›äº†æ¸¬è©¦è…³æœ¬ `test_pdf_watermark.py` ç”¨æ–¼æ¸¬è©¦ PDF æµ®æ°´å°åŠŸèƒ½ï¼š

```bash
python test_pdf_watermark.py
```

**æ¸¬è©¦å‰æº–å‚™ï¼š**
1. æº–å‚™æ¸¬è©¦ PDF æ–‡ä»¶ï¼ˆå‘½åç‚º `test_input.pdf`ï¼‰
2. æº–å‚™æµ®æ°´å°åœ–ç‰‡ï¼ˆå‘½åç‚º `watermark.png`ï¼Œç”¨æ–¼æ¸¬è©¦åœ–ç‰‡æµ®æ°´å°ï¼‰

## ç³»çµ±éœ€æ±‚

### å¿…è¦å¥—ä»¶
- `pypdf` - PDF æ–‡ä»¶è™•ç†
- `reportlab` - PDF ç”Ÿæˆå’Œç¹ªåœ–
- `Pillow` - åœ–ç‰‡è™•ç†ï¼ˆç”¨æ–¼åœ–ç‰‡æµ®æ°´å°ï¼‰

### å®‰è£ä¾è³´

```bash
pip install pypdf reportlab Pillow
```

æˆ–ä½¿ç”¨ requirements.txtï¼š

```bash
pip install -r requirements.txt
```

## æ”¯æ´çš„å­—å‹

ç³»çµ±æœƒæ ¹æ“šä½œæ¥­ç³»çµ±è‡ªå‹•é¸æ“‡åˆé©çš„ä¸­æ–‡å­—å‹ï¼š

- **Windows**: å¾®è»Ÿæ­£é»‘é«” (msjh.ttc) æˆ–æ–°ç´°æ˜é«” (simsun.ttc)
- **Linux**: Noto Sans CJK æˆ–æ–‡æ³‰é©›æ­£é»‘
- **macOS**: PingFang æˆ–é»‘é«”

## å¸¸è¦‹å•é¡Œ

### Q: ç‚ºä»€éº¼æµ®æ°´å°çš„ä¸­æ–‡å­—é¡¯ç¤ºä¸æ­£ç¢ºï¼Ÿ

A: ç¢ºä¿ç³»çµ±å·²å®‰è£ä¸­æ–‡å­—é«”ã€‚ç¨‹å¼æœƒè‡ªå‹•å˜—è©¦è¼‰å…¥ç³»çµ±ä¸­æ–‡å­—é«”ï¼Œå¦‚æœè¼‰å…¥å¤±æ•—æœƒä½¿ç”¨é è¨­å­—é«”ã€‚

### Q: å¯ä»¥ç‚º PDF çš„ç‰¹å®šé é¢æ·»åŠ æµ®æ°´å°å—ï¼Ÿ

A: ç›®å‰åŠŸèƒ½æœƒè‡ªå‹•ç‚ºæ‰€æœ‰é é¢æ·»åŠ æµ®æ°´å°ã€‚å¦‚éœ€ç‚ºç‰¹å®šé é¢æ·»åŠ ï¼Œå¯ä»¥ä¿®æ”¹ `doc_converter.py` ä¸­çš„ç›¸é—œå‡½æ•¸ã€‚

### Q: æµ®æ°´å°æœƒå½±éŸ¿ PDF çš„æ–‡å­—é¸å–æˆ–è¤‡è£½å—ï¼Ÿ

A: ä¸æœƒã€‚æµ®æ°´å°æ˜¯ä½œç‚ºåœ–å±¤è¦†è“‹åœ¨åŸå§‹å…§å®¹ä¸Šï¼Œä¸æœƒå½±éŸ¿åŸå§‹æ–‡å­—ã€‚

### Q: æ”¯æ´æ‰¹æ¬¡è™•ç†å¤šå€‹ PDF å—ï¼Ÿ

A: ç›®å‰ GUI ä»‹é¢ä¸€æ¬¡è™•ç†ä¸€å€‹ PDFã€‚å¦‚éœ€æ‰¹æ¬¡è™•ç†ï¼Œå¯ä»¥ç·¨å¯« Python è…³æœ¬å¾ªç’°èª¿ç”¨æµ®æ°´å°å‡½æ•¸ã€‚

### Q: æµ®æ°´å°åœ–ç‰‡çš„æœ€ä½³æ ¼å¼æ˜¯ä»€éº¼ï¼Ÿ

A: å»ºè­°ä½¿ç”¨ PNG æ ¼å¼ï¼Œæ”¯æ´é€æ˜èƒŒæ™¯ï¼Œæ•ˆæœæœ€ä½³ã€‚

## é€²éšç”¨æ³•

### æ‰¹æ¬¡æ·»åŠ æµ®æ°´å°

```python
import os
from utils.doc_converter import add_text_watermark_to_pdf

# æ‰¹æ¬¡è™•ç†è³‡æ–™å¤¾ä¸­çš„æ‰€æœ‰ PDF
input_folder = "pdfs"
output_folder = "watermarked_pdfs"

os.makedirs(output_folder, exist_ok=True)

for filename in os.listdir(input_folder):
    if filename.endswith('.pdf'):
        input_path = os.path.join(input_folder, filename)
        output_path = os.path.join(output_folder, filename)

        add_text_watermark_to_pdf(
            input_path,
            output_path,
            "Â© 2025 Your Company",
            position='bottom-right',
            opacity=0.3
        )
        print(f"å·²è™•ç†: {filename}")
```

### æ ¹æ“šæ¢ä»¶å‹•æ…‹è¨­å®šæµ®æ°´å°

```python
from utils.doc_converter import add_text_watermark_to_pdf
import datetime

# æ ¹æ“šæ—¥æœŸç”Ÿæˆæµ®æ°´å°
today = datetime.date.today()
watermark_text = f"åˆ—å°æ—¥æœŸ: {today.strftime('%Y-%m-%d')}"

add_text_watermark_to_pdf(
    "document.pdf",
    "document_dated.pdf",
    watermark_text,
    position='bottom-left',
    opacity=0.5,
    font_size=10,
    rotation=0
)
```

## æŠ€è¡“ç´°ç¯€

### å¯¦ä½œåŸç†

1. **æ–‡å­—æµ®æ°´å°**ï¼š
   - ä½¿ç”¨ ReportLab å‰µå»ºåŒ…å«æ–‡å­—çš„è‡¨æ™‚ PDF
   - è¨­å®šå­—é«”ã€é¡è‰²ã€é€æ˜åº¦
   - ä½¿ç”¨ PyPDF å°‡æµ®æ°´å° PDF åˆä½µåˆ°åŸå§‹é é¢

2. **åœ–ç‰‡æµ®æ°´å°**ï¼š
   - ä½¿ç”¨ Pillow è¼‰å…¥ä¸¦è™•ç†åœ–ç‰‡
   - èª¿æ•´åœ–ç‰‡å¤§å°å’Œé€æ˜åº¦
   - ä½¿ç”¨ ReportLab å°‡åœ–ç‰‡ç¹ªè£½åˆ°è‡¨æ™‚ PDF
   - ä½¿ç”¨ PyPDF åˆä½µåˆ°åŸå§‹é é¢

### æ•ˆèƒ½è€ƒé‡

- è™•ç†å¤§å‹ PDFï¼ˆ100+ é ï¼‰å¯èƒ½éœ€è¦è¼ƒé•·æ™‚é–“
- å»ºè­°æµ®æ°´å°åœ–ç‰‡ä¸è¦å¤ªå¤§ï¼ˆæ¨è–¦ 500x500 åƒç´ ä»¥å…§ï¼‰
- é€æ˜åº¦è¨­å®šè¶Šä½ï¼Œè™•ç†é€Ÿåº¦è¶Šå¿«

## æ›´æ–°æ—¥èªŒ

### v6.0 (2025-01)
- âœ¨ æ–°å¢ PDF æµ®æ°´å°åŠŸèƒ½
- âœ¨ æ”¯æ´æ–‡å­—å’Œåœ–ç‰‡æµ®æ°´å°
- âœ¨ æ”¯æ´ 5 ç¨®ä½ç½®é¸æ“‡
- âœ¨ æ”¯æ´é€æ˜åº¦å’Œæ—‹è½‰è§’åº¦èª¿æ•´
- âœ¨ GUI æ•´åˆå®Œæˆ

## æˆæ¬Š

æœ¬åŠŸèƒ½å±¬æ–¼ MediaToolkit v6.0 çš„ä¸€éƒ¨åˆ†ï¼Œéµå¾ª MIT æˆæ¬Šæ¢æ¬¾ã€‚

## ä½œè€…

**Dof Liu AIå·¥ä½œå®¤**
Â© 2025 All Rights Reserved.

## æŠ€è¡“æ”¯æ´

å¦‚æœ‰å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¯ç¹«é–‹ç™¼åœ˜éšŠæˆ–åœ¨ GitHub æäº¤ Issueã€‚
